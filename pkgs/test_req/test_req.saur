[use "math"]
[use "fmt"]

[box test [block
    [var inner_thing 33]
    [var x [lambda [] [block
        [yield inner_thing]
    ]]]
]]

[var thing test]

[set thing.inner_thing 4]

[assert "nope" [== 4 [thing.x]]]


;
;   Lambdas in boxes are having the env set to the
;   env of the definition of the box
;
;   Would need to clone the env suring the creation of the box
;   instance.... need to think

;


[putln [math.log 5]]

[var x [lambda [] [block
    [putln [fmt.string "\n\n\t[SUCCESS]\n\n"]]
]]]

[var test [lambda [] [block
    [x]
]]]



[test]